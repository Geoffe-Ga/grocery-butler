{
  "number": 3,
  "title": "Prompt templates: all Claude prompt .txt files",
  "state": "open",
  "labels": [
    {"name": "phase:1-tracer"},
    {"name": "priority:P0"},
    {"name": "component:backend"}
  ],
  "milestone": {"title": "Phase 1: Wire the Skeleton"},
  "body": "## Summary\n\nCreate all Claude prompt template files and a loader utility. These are the \"instructions\" that drive MealBot's intelligence — they must exist before any Claude-calling module can work.\n\n## Context\n\nThe spec requires all prompts stored as `.txt` files in `grocery_butler/prompts/`, loaded at runtime and formatted with context variables. This keeps prompts versionable and editable without touching Python code.\n\n## Acceptance Criteria\n\n### Prompt files (copy verbatim from spec)\n\n- [ ] `grocery_butler/prompts/meal_decomposition.txt` — meal-to-ingredient decomposition. Variables: `{default_servings}`, `{dietary_restrictions}`, `{pantry_staples}`, `{units}`, `{known_recipes}`\n- [ ] `grocery_butler/prompts/ingredient_consolidation.txt` — multi-meal merge into shopping list. Variables: `{pantry_staples}`, `{restock_queue}`, `{restock_items}`\n- [ ] `grocery_butler/prompts/recipe_matching.txt` — fuzzy recipe name matching. Variables: `{query}`, `{recipe_list}`\n- [ ] `grocery_butler/prompts/inventory_intent.txt` — natural language inventory update detection. Variables: `{user_message}`, `{current_inventory}`\n- [ ] `grocery_butler/prompts/product_selection.txt` — placeholder for future Safeway use, content: `# Future use: Safeway product selection\\nThis prompt will be implemented in Phase 3.`\n- [ ] `grocery_butler/prompts/substitution_ranking.txt` — placeholder for future Safeway use\n- [ ] `grocery_butler/prompts/brand_selection.txt` — placeholder for future Safeway use\n\n### Prompt loader utility\n\n- [ ] Function `load_prompt(name: str, **kwargs) -> str` in a small utility module (e.g., `grocery_butler/prompt_loader.py`)\n- [ ] Loads from `prompts/` directory relative to package\n- [ ] Calls `.format(**kwargs)` on the template\n- [ ] Raises clear error if template file not found or missing variable\n- [ ] Uses `{{` / `}}` for literal braces in JSON examples (already done in spec templates)\n\n### Test\n\n- [ ] `tests/test_prompt_loader.py` — load each template, verify it formats without error when given expected variables, verify missing variable raises `KeyError`\n\n## File Inventory\n\n```\ngrocery_butler/\n├── prompt_loader.py\n├── prompts/\n│   ├── meal_decomposition.txt\n│   ├── ingredient_consolidation.txt\n│   ├── recipe_matching.txt\n│   ├── inventory_intent.txt\n│   ├── product_selection.txt\n│   ├── substitution_ranking.txt\n│   └── brand_selection.txt\ntests/\n└── test_prompt_loader.py\n```\n\n## Blocked By\n\n#1 (foundation — needs models for context on what variables exist)\n\n## Blocks\n\n#6 (meal parser), #7 (consolidator) — both call Claude with these templates"
}
